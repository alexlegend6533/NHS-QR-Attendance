<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NHS | Attendance Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root { --bg: #0b0f1a; --accent: #38bdf8; --text-dim: #94a3b8; }
        body { font-family: sans-serif; background: var(--bg); color: white; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        .admin-panel { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #0f172a; border-right: 1px solid rgba(255,255,255,0.05); }
        .qr-panel { flex: 1.5; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        .editable-box { background: rgba(255,255,255,0.03); border: 1px solid rgba(56,189,248,0.2); border-radius: 16px; padding: 20px; font-size: 2.5rem; color: white; text-align: center; width: 300px; margin-bottom: 20px; }
        .qr-container { background: white; padding: 30px; border-radius: 28px; margin: 30px 0; }
        #timer { font-size: 100px; color: var(--accent); font-weight: 200; }
        #status { position: absolute; top: 30px; right: 30px; font-size: 0.7rem; color: #10b981; }
    </style>
</head>
<body>
    <div id="status">‚óè LOCAL ENGINE ACTIVE</div>
    <div class="admin-panel">
        <input type="text" class="editable-box" value="02/11/2026">
        <input type="text" class="editable-box" value="Service">
    </div>
    <div class="qr-panel">
        <h1 style="letter-spacing:4px; color:var(--text-dim)">NHS CHECK-IN</h1>
        <div id="timer">5s</div>
        <div class="qr-container"><div id="qrcode"></div></div>
        <div style="font-size:0.8rem; color:var(--text-dim)">INTERNAL SEQUENCE PROTECTION</div>
    </div>

    <script>
        const DEPLOY_URL = "https://script.google.com/a/macros/houstonchristian.org/s/AKfycbzWX5HiqCKtXR6hICpgHsExNwgSdwY72dk0NcoXe6ml_19IbD-DsvVuizHD8C3XbVDvNw/exec";
        let timeLeft = 5;

        function updateQR() {
            const container = document.getElementById("qrcode");
            container.innerHTML = "";
            // Generate key based on current Unix time, rotating every 5 seconds
            const ùê§ = Math.floor(Date.now() / 5000);
            new QRCode(container, { 
                text: `${DEPLOY_URL}?key=${ùê§}`, 
                width: 400, height: 400 
            });
        }

        setInterval(() => {
            timeLeft--;
            if (timeLeft <= 0) {
                updateQR();
                timeLeft = 5;
            }
            document.getElementById('timer').innerText = timeLeft + "s";
        }, 1000);

        updateQR();
    </script>
</body>
</html>
